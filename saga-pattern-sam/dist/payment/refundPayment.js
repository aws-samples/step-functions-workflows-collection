"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.handler = void 0;
const { DynamoDB } = require('aws-sdk');
exports.handler = async function (event) {
    console.log("request:", JSON.stringify(event, undefined, 2));
    let paymentID = '';
    if (typeof event.ProcessPaymentResult !== 'undefined') {
        paymentID = event.ProcessPaymentResult.Payload.payment_id;
    }
    const dynamo = new DynamoDB();
    var params = {
        TableName: process.env.TABLE_NAME,
        Key: {
            'pk': { S: event.trip_id },
            'sk': { S: paymentID }
        }
    };
    // Call DynamoDB to remove the item from the table
    let result = await dynamo.deleteItem(params).promise().catch((error) => {
        throw new Error(error);
    });
    console.log('Payment has been refunded');
    console.log(result);
    return {
        status: "ok",
    };
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVmdW5kUGF5bWVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL2xhbWJkYXMvcGF5bWVudC9yZWZ1bmRQYXltZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFBLE1BQU0sRUFBRSxRQUFRLEVBQUUsR0FBRyxPQUFPLENBQUMsU0FBUyxDQUFDLENBQUM7QUFHM0IsUUFBQSxPQUFPLEdBQUcsS0FBSyxXQUFVLEtBQVM7SUFDN0MsT0FBTyxDQUFDLEdBQUcsQ0FBQyxVQUFVLEVBQUUsSUFBSSxDQUFDLFNBQVMsQ0FBQyxLQUFLLEVBQUUsU0FBUyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFHN0QsSUFBSSxTQUFTLEdBQUcsRUFBRSxDQUFDO0lBQ25CLElBQUksT0FBTyxLQUFLLENBQUMsb0JBQW9CLEtBQUssV0FBVyxFQUFFO1FBQ3JELFNBQVMsR0FBRyxLQUFLLENBQUMsb0JBQW9CLENBQUMsT0FBTyxDQUFDLFVBQVUsQ0FBQztLQUMzRDtJQUdELE1BQU0sTUFBTSxHQUFHLElBQUksUUFBUSxFQUFFLENBQUM7SUFFOUIsSUFBSSxNQUFNLEdBQUc7UUFDWCxTQUFTLEVBQUUsT0FBTyxDQUFDLEdBQUcsQ0FBQyxVQUFVO1FBQ2pDLEdBQUcsRUFBRTtZQUNILElBQUksRUFBRyxFQUFDLENBQUMsRUFBRSxLQUFLLENBQUMsT0FBTyxFQUFDO1lBQ3pCLElBQUksRUFBRyxFQUFDLENBQUMsRUFBRSxTQUFTLEVBQUM7U0FDdEI7S0FDRixDQUFDO0lBRUYsa0RBQWtEO0lBQ2xELElBQUksTUFBTSxHQUFHLE1BQU0sTUFBTSxDQUFDLFVBQVUsQ0FBQyxNQUFNLENBQUMsQ0FBQyxPQUFPLEVBQUUsQ0FBQyxLQUFLLENBQUMsQ0FBQyxLQUFVLEVBQUUsRUFBRTtRQUMxRSxNQUFNLElBQUksS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ3pCLENBQUMsQ0FBQyxDQUFDO0lBRUgsT0FBTyxDQUFDLEdBQUcsQ0FBQywyQkFBMkIsQ0FBQyxDQUFDO0lBQ3pDLE9BQU8sQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLENBQUM7SUFHcEIsT0FBTztRQUNMLE1BQU0sRUFBRSxJQUFJO0tBQ2IsQ0FBQTtBQUNILENBQUMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHsgRHluYW1vREIgfSA9IHJlcXVpcmUoJ2F3cy1zZGsnKTtcbmV4cG9ydCB7fTtcblxuZXhwb3J0IGNvbnN0IGhhbmRsZXIgPSBhc3luYyBmdW5jdGlvbihldmVudDphbnkpIHtcbiAgY29uc29sZS5sb2coXCJyZXF1ZXN0OlwiLCBKU09OLnN0cmluZ2lmeShldmVudCwgdW5kZWZpbmVkLCAyKSk7XG5cblxuICBsZXQgcGF5bWVudElEID0gJyc7XG4gIGlmICh0eXBlb2YgZXZlbnQuUHJvY2Vzc1BheW1lbnRSZXN1bHQgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgcGF5bWVudElEID0gZXZlbnQuUHJvY2Vzc1BheW1lbnRSZXN1bHQuUGF5bG9hZC5wYXltZW50X2lkO1xuICB9XG5cblxuICBjb25zdCBkeW5hbW8gPSBuZXcgRHluYW1vREIoKTtcblxuICB2YXIgcGFyYW1zID0ge1xuICAgIFRhYmxlTmFtZTogcHJvY2Vzcy5lbnYuVEFCTEVfTkFNRSxcbiAgICBLZXk6IHtcbiAgICAgICdwaycgOiB7UzogZXZlbnQudHJpcF9pZH0sXG4gICAgICAnc2snIDoge1M6IHBheW1lbnRJRH1cbiAgICB9XG4gIH07XG4gIFxuICAvLyBDYWxsIER5bmFtb0RCIHRvIHJlbW92ZSB0aGUgaXRlbSBmcm9tIHRoZSB0YWJsZVxuICBsZXQgcmVzdWx0ID0gYXdhaXQgZHluYW1vLmRlbGV0ZUl0ZW0ocGFyYW1zKS5wcm9taXNlKCkuY2F0Y2goKGVycm9yOiBhbnkpID0+IHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3IpO1xuICB9KTtcblxuICBjb25zb2xlLmxvZygnUGF5bWVudCBoYXMgYmVlbiByZWZ1bmRlZCcpO1xuICBjb25zb2xlLmxvZyhyZXN1bHQpO1xuXG4gIFxuICByZXR1cm4ge1xuICAgIHN0YXR1czogXCJva1wiLFxuICB9XG59OyJdfQ==